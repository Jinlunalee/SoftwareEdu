<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mycompany.webapp.dao.IEnrollRepository">

	<select id="getEnrollList" resultType="EnrollVO">
		SELECT enroll_id AS "enrollId", 
		subject_id AS "subjectId", 
		subject_seq AS "subjectSeq", 
		student_id AS "studentId", 
		state_cd AS "stateCd", 
		complete_hours AS "completeHours", 
		reg_id AS "regId", 
		reg_dt AS "regDt", 
		modi_id AS "modiId", 
		modi_dt AS "modiDt", 
		del_yn AS "delYn", 
		cancel_rs_cd AS "cancelRsCd", 
		cancel_rs_etc AS "cancelRsEtc" 
		FROM ENROLL
	</select>
	
	<select id="getEnrollDetails" resultType="EnrollVO">
		SELECT enroll_id AS "enrollId", 
		subject_id AS "subjectId", 
		subject_seq AS "subjectSeq", 
		student_id AS "studentId", 
		state_cd AS "stateCd", 
		complete_hours AS "completeHours", 
		reg_id AS "regId", 
		reg_dt AS "regDt", 
		modi_id AS "modiId", 
		modi_dt AS "modiDt", 
		del_yn AS "delYn", 
		cancel_rs_cd AS "cancelRsCd", 
		cancel_rs_etc AS "cancelRsEtc" 
		FROM ENROLL
	</select>
	
	<select id="getSubjectDetails" parameterType = "String" resultType="SubjectVO">
		SELECT s.subject_id AS "subjectId", 
				subject_title AS "subjectTitle", 
				support_yn AS "supportYn", 
				cat_cd AS "catCd", 
				days AS "days", 
				hours AS "hours", 
				level_cd AS "levelCd", 
				level_etc AS "levelEtc", 
				cost AS "cost", 
				reg_year AS "regYear" 
		FROM SUBJECT s
		LEFT OUTER JOIN ENROLL e 
		ON s.subject_id = e.subject_id and e.subject_id = #{subjectId}
	</select>
	
	<select id="getName" parameterType="String" resultType="StudentVO">
		SELECT name AS "name" 
		FROM STUDENT 
		WHERE student_id = #{studentId}
	</select>
	
	<select id="getSubjectName" parameterType="String" resultType="SubjectVO">
		SELECT subject_title AS "subjectTitle"
		FROM SUBJECT
		WHERE subject_id = #{subjectId}
	</select>
	
	<select id="getOpenDetails" resultType="EnrollVO">
		SELECT start_time AS "startTime", 
				end_time AS "endTime", 
				start_day AS "startDay", 
				end_day AS "endDay"
		FROM OPEN o, ENROLL e
		WHERE o.subject_id = e.subject_id AND o.subject_seq = e.subject_seq
	</select>
	
	<select id="getProgress" parameterType="String" resultType="int">
		SELECT e.complete_hours/s.hours * 100
		FROM ENROLL e, SUBJECT s
		WHERE e.subject_id = s.subject_id AND e.student_id = #{studentId}
	</select>



</mapper>